const logger = require('../../config/winston-config');
const azure = require('./azure/azure');
const Application = require('../models/application');

exports.submitApp = async (type, filePath, fileName) => {
  let result = await Application.findOne({ path: fileName });
  if (!result) {
    logger.info('record already exists');
    result = await Application.create({
      path: filePath,
      description: '',
      approved: false,
      type,
    });
  }
  logger.info(`result ${result}`);
  await azure.uploadFileToContainer(filePath);
  return result.id;
};
