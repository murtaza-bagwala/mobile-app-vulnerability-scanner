import React, { useState, useEffect } from "react";
import ListItem from "./ListItem";
import axios from "axios";
import { connect } from "react-redux";
import * as appActions from "../redux/actions/appAction";

const AppList = ({apps, listApps}) => {
	const [items, setItems] = useState([...apps]);

	const getResults = async () => {
		debugger;
		if (apps.length === 0) {
			const url = "http://localhost:4001/app/all";
			const result = await axios.get(url)
			listApps(result.data.data);
		} else {
			setItems([...apps])
		}
	};
	

	useEffect(() => {
		getResults();
	}, [apps]);

  return (items.map(item => <ListItem key={item.id} item={item} />))
};

const mapStateToProps = state => {
	debugger
	return {
		apps: state.apps
	}
};

const mapDispatchToProps = {
	listApps: appActions.listApps
}

export default connect(mapStateToProps, mapDispatchToProps)(AppList);
